<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Real-Time Classroom Feedback System</title>

  <!-- External Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>

  <!-- Custom Styles -->
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>🎓 Real-Time Classroom Feedback</h1>
      <p>Enhance teaching effectiveness with instant student feedback</p>
    </div>

    <!-- Tabs -->
    <div class="tabs">
      <button class="tab-button active" onclick="switchTab('teacher')">👩‍🏫 Teacher Dashboard</button>
      <button class="tab-button" onclick="switchTab('student')">👨‍🎓 Student Feedback</button>
      <button class="tab-button" onclick="switchTab('analytics')">📊 Analytics</button>
    </div>

    <div class="tab-content">

      <!-- Teacher Dashboard -->
      <div id="teacher" class="tab-pane active">
        <div class="dashboard-grid">
          <div class="card">
            <h3>🚀 Create New Session</h3>
            <div class="form-group">
              <label for="subject">Subject</label>
              <input type="text" id="subject" class="form-control" placeholder="e.g., Mathematics"/>
            </div>
            <div class="form-group">
              <label for="teacher">Teacher Name</label>
              <input type="text" id="teacher" class="form-control" placeholder="Your name"/>
            </div>
            <div class="form-group">
              <label for="topic">Today's Topic</label>
              <input type="text" id="topic" class="form-control" placeholder="e.g., Quadratic Equations"/>
            </div>
            <button class="btn btn-primary" onclick="startSession()">Start Feedback Session</button>
          </div>

          <div class="card">
            <h3>📱 QR Code</h3>
            <div id="qrDisplay" class="qr-display">
              <div class="empty-state">
                <div class="emoji">📱</div>
                <p>Click "Start Feedback Session" to generate QR code</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Student Feedback -->
      <div id="student" class="tab-pane">
        <div class="feedback-form">
          <h2 style="text-align:center;color:#667eea;margin-bottom:30px;">📝 Share Your Feedback</h2>
          
          <div class="form-group">
            <label for="sessionInput">Session ID (or scan QR code)</label>
            <input type="text" id="sessionInput" class="form-control" placeholder="Enter session ID"/>
            <button class="btn btn-secondary" onclick="showFeedbackForm()">Join Session</button>
          </div>

          <div id="feedbackSection" style="display:none;">
            <div class="form-group">
              <label>How well did you understand today's topic?</label>
              <div class="rating-options">
                <div class="rating-option" data-rating="5" onclick="setRating(5)">😍 Perfectly Clear</div>
                <div class="rating-option" data-rating="4" onclick="setRating(4)">😊 Well Understood</div>
                <div class="rating-option" data-rating="3" onclick="setRating(3)">🙂 Partially Clear</div>
                <div class="rating-option" data-rating="2" onclick="setRating(2)">😕 Somewhat Confused</div>
                <div class="rating-option" data-rating="1" onclick="setRating(1)">😵 Very Confused</div>
              </div>
            </div>
            <div class="form-group">
              <label for="comment">Additional Comments (Optional)</label>
              <textarea id="comment" class="comment-box" placeholder="Share your thoughts..."></textarea>
            </div>
            <div style="text-align:center;">
              <button class="btn btn-primary" onclick="submitFeedback()">🚀 Submit Feedback</button>
            </div>
          </div>

          <div id="thankYou" style="display:none;text-align:center;padding:40px;">
            <div style="font-size:4rem;margin-bottom:20px;">🎉</div>
            <h3 style="color:#667eea;">Thank You!</h3>
            <p>Your feedback has been submitted successfully.</p>
          </div>
        </div>
      </div>

      <!-- Analytics -->
      <div id="analytics" class="tab-pane">
        <h2 style="text-align:center;color:#667eea;margin-bottom:30px;">📈 Historical Analytics</h2>
        <div class="form-group" style="text-align:center;">
          <input type="text" id="analyticsSessionId" class="form-control" placeholder="Enter Session ID"/>
          <button class="btn btn-primary" onclick="loadAnalytics()">View Analytics</button>
        </div>
        
        <div class="stats-grid">
          <div class="stat-card"><div class="stat-number" id="totalSessions">0</div><div class="stat-label">Total Sessions</div></div>
          <div class="stat-card"><div class="stat-number" id="totalStudentResponses">0</div><div class="stat-label">Student Responses</div></div>
          <div class="stat-card"><div class="stat-number" id="avgSessionRating">0</div><div class="stat-label">Average Rating</div></div>
        </div>

        <!-- Charts Section -->
        <div class="charts-container">
          <div class="chart-card">
            <canvas id="ratingChart"></canvas>
          </div>
          <div class="chart-card">
            <canvas id="trendChart"></canvas>
          </div>
        </div>

        <!-- Comments Section -->
        <div class="chart-card" style="margin-top:20px;">
          <div id="feedbackComments"></div>
        </div>
      </div>

    </div>
  </div>

  <!-- Custom JavaScript -->
  <script src="script.js"></script>

  <script>
    window.onload = () => {
      const params = new URLSearchParams(window.location.search);
      if (params.has("sessionId")) {
        document.getElementById("sessionInput").value = params.get("sessionId");
        showFeedbackForm();
      }
    };
  </script>
</body>
</html>